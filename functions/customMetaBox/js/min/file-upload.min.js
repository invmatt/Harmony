jQuery(document).ready(function(){jQuery(document).on("click",".cmb-file-upload",function(t){t.preventDefault();var i=jQuery(this).parent(),a=jQuery(this),r=wp.media({state:"cmb-file",states:[new e]});r.on("toolbar:create:cmb-file",function(e){this.createSelectToolbar(e,{text:"Select file"})},r),r.open(),r.state("cmb-file").on("select",function(){var e=r.state().get("selection"),t=e.first(),l=i.find(".cmb-file-holder");jQuery(i).find(".cmb-file-upload-input").val(t.id),a.hide(),r.close();var n="image"===t.attributes.type?"type-image":"type-file";l.addClass(n),l.html(""),l.parent().show(),jQuery("<img />",{src:"image"===t.attributes.type?t.attributes.sizes.thumbnail.url:t.attributes.icon}).prependTo(i.find(".cmb-file-holder")),"image"!==t.attributes.type&&l.append(jQuery('<div class="cmb-file-name" />').html("<strong>"+t.attributes.filename+"</strong>"))})}),jQuery(document).on("click",".cmb-remove-file",function(e){e.preventDefault();var t=jQuery(this).parent().parent();t.find(".cmb-file-holder").html("").parent().hide(),t.find(".cmb-file-upload-input").val(""),t.find(".cmb-file-upload").show()});var e=wp.media.controller.Library.extend({defaults:_.defaults({id:"cmb-file",filterable:"uploaded",multiple:!1,toolbar:"cmb-file",title:"Select File",priority:60,syncSelection:!1},wp.media.controller.Library.prototype.defaults),initialize:function(){var e,t;wp.media.controller.Library.prototype.initialize.apply(this,arguments),e=this.get("library"),t=e.comparator},activate:function(){this.updateSelection(),this.frame.on("open",this.updateSelection,this),wp.media.controller.Library.prototype.activate.apply(this,arguments)},deactivate:function(){this.frame.off("open",this.updateSelection,this),wp.media.controller.Library.prototype.deactivate.apply(this,arguments)},updateSelection:function(){var e,t=this.get("selection"),i=wp.media.view.settings.post.featuredImageId;""!==i&&-1!==i&&(e=wp.media.model.Attachment.get(i),e.fetch()),t.reset(e?[e]:[])}})});